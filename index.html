<!DOCTYPE html>
<html lang="en">  
  <head>
    <style type="text/css">html,body{background:black};</style>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta property="og:title" content="{{tld}} Domains" />
    <meta property="og:image" content="/preview.png" />
    <link href="reset.css" rel="stylesheet" type="text/css" />
    <!-- <link href="theme.css" rel="stylesheet" type="text/css" /> -->
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link href='https://fonts.googleapis.com/css?family=Roboto Mono' rel='stylesheet'>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="theme-color" content="#00ffb3">
    <title data-tld>{{tld}} Domains</title>
  </head>
  <body>  
    <header>
      <h1 data-tld class="title">
        {{tld}} Domains
      </h1>
      <div class="subtitle">Decentralized domains on Ethereum</div>
      <div class="subtitle">in a decentralized root zone</div>
      <div class="subtitle">on Handshake</div>
    </header>
    <main>
      <div class="search">
        <div id="card" class="domain flashy">
          <img width="816" height="816" alt="Mostly transparent rainy city window gif." src="https://i.gifer.com/2zFX.gif" />
          <span>
            <h2 data-std="domainname" data-tld>{{tld}}</h2>
          </span>
        </div>
        <span>
          <input id="domainname" type="text" class="searchbox" placeholder="Enter domain" onchange="updateHandler()" onkeyup="updateHandler()" onkeydown="keyDownHandler()"> 
          <div data-tld class="subtitle green">{{tld}}</div>
        </span>
      </div>
      <div class="wrap-collabsible">
        <input id="collapsible" class="toggle" type="checkbox"></input>
        <label data-tld for="collapsible" class="lbl-toggle">
          How to access {{tld}} sites
        </label>
        <div class="collapsible-content">
          <div class="content-inner">
            <div>
              (1) <a target="_blanc" href="https://impervious.com/fingertip">Fingertip</a> Resolver, 
              (2) <a target="_blanc" href="https://impervious.com/beacon">Beacon</a> Browser, 
              (3) <a target="_blanc" href="https://hns.is/">Hns.is</a> Gateway,
              (4) <a target="_blanc" href="https://github.com/handshake-org/hsd">HSD</a> Fullnode
            </div>
            <br/>
          </div>
        </div>
      </div>
      <div class="wrap-collabsible">
        <input id="collapsible2" class="toggle" type="checkbox"></input>
        <label data-tld for="collapsible2" class="lbl-toggle">
          How to set up {{tld}} sites
        </label>
        <div class="collapsible-content">
          <div class="content-inner">
            <div>
              (1) Handshake web hosting options include using a personal <a target="_blanc" href="https://github.com/pinheadmz/handout">webserver</a>, <a target="_blanc" href="https://www.instructables.com/Nginx-DANE-Hosting-on-Google-VM-for-Handshake/">NGINX + Google VM</a> or <a target="_blanc" href="https://docs.ipfs.tech/how-to/websites-on-ipfs/link-a-domain/#handshake">IPFS</a>.
              <br/>
              <br/>
              <div>
                then
              </div>
              <br/>
              (2a) Connect your domain by adding name records directly on Ethereum
              <br/>
              <br/>
              <div>
                or
              </div>
              <br/>
              (2b) Point NS records to a <a target="_blanc" href="https://hshub.io/">public</a> or <a target="_blanc" href="https://github.com/pinheadmz/handout">self-hosted</a> nameserver to add records off-chain
            </div>
            <br/>
          </div>
        </div>
      </div>
    </main>
    <!-- <div class="footer"> -->
    <footer>
      Website by <a href="https://theshake.xyz/" target="_blanc">The Shake</a>
      <div id="contact">
        <img src="">
        <a id="chat" href="" target='_blanc'>Chat support</a>
      </div>
    </footer>

    <script type="module" src="options.js"></script>
    <script>
      const options = window.options;
      
      const chatLink = `https://hns.chat/#message:${options.support.chatname}`;

      const card = document.body.querySelector(`#card`);
      const input = document.body.querySelector(`#domainname`);
      const showcase = document.body.querySelector(`[data-std="domainname"]`);

      function randomizeColor() {
        const randomGradient = options.color[Math.floor(Math.random()*options.color.length)];
        card.classList.add("fader");
        card.style.background = randomGradient;
        setTimeout(() => {
          card.classList.remove("fader");
        }, 400);
      };

      function rewritePage() {
        const allElements = Array.from(document.querySelectorAll(`[data-tld]`));
        allElements.forEach(element => {
          const t = element.innerText;
          const r = t.replace("{{tld}}",options.tld);
          element.innerText = r;
        });
        document.body.querySelector(`#chat`).href = chatLink;
      };

      function keydownHandler() {
        if (event.key === 'Enter') {
          const url = `https://impervious.domains/name/${event.target.value}${options.tld}/register/`;
          location.target = '_blanc';
          location.href = url;
        };
      };

      function setDomain(n) {
        showcase.innerText = n;
      };

      function updateHandler() {
        const domain = event.target.value + options.tld;
        setDomain(domain);
        randomizeColor();
      };

      function loadedHandler() {
        rewritePage();
      };

      document.addEventListener("DOMContentLoaded", 
        loadedHandler
      , false);
    </script>
  </body>
</html>
